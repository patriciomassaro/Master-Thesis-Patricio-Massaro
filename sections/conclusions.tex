\section{Conclusions}

In this thesis, the feasibility of applying blind single-image super resolution algorithms to thermal remote sensing data from OroraTechâ€™s FOREST-2 mission was studied. The study centers on these key research questions:

\begin{itemize}
    \item Is it possible to estimate the FOREST-2 degradation model using a data driven approach?
    \item What is the impact of the unknown degradation model compared to the one commonly used for dataset generation?
    \item How can the degradation model be incorporated in training to improve SR results?
    \item  How can the SR results be assessed, when paired data is scarce?
\end{itemize}

In order to have HR ground truth data, an automated process for fetching, filtering and processing data from third-party, higher resolution missions was developed, with the objective of obtaining synthetic HR FOREST-2 data. 
The conventional method for dataset pairs generation of downscaling + adding white noise was proven inadequate in Section \ref{sec:results}. The domain gap between the degraded and real LR images is too large, resulting in an SR model that is not able to generalize to FOREST-2 images, rendering blurry results.

Blind super resolution techniques were explored as a solution in Section \ref{sec:methodology}. The current  lack of paired ECOSTRESS and FOREST-2 data lead to the decision of using implicit modelling for the degradation process estimation through a GAN architecture. A probabilistic degradation model was proposed for the task, mainly for three reasons. First, its well-constrained kernel and noise modules allow the training of an end-to-end pipeline of degradation and SR. Second, using deep learning to generate the kernel and noise allows to analyze the degradation process and to understand its impact. Last, the stochastic nature of the architecture allows  sampling from the degradation distribution to generate a wide variety of HR-LR pairs from only one HR image, which is very useful for augmenting the training datasets.


% Down-stream users of LST products like wildfire management and urban heat studies need high spatial and temporal resolutions. They represent requirements which are not fully covered by the current thermal remote sensing missions.
% Because of different variables like payload capacity of the missions, sensor technology and cost, there is a trade-off between spatial and temporal resolutions.
% While OroraTech is working on improving the revisit time by using constellations of cubesats like FOREST-2, combining this with high spatial resolution remains a challenge where super resolution offers a solution.

% As a supervised problem, super resolution requires a paired dataset of HR-LR images. This is not directly tractable for FOREST-2's sensor, because HR images are not available.
% Data from third-party missions with higher spatial resolution can used to create a synthetic HR FOREST-2 data to work around the lack of ground truth. ECOSTRESS is an ideal candidate for substitution as its spectral and spatial characteristics match very well with FOREST-2's sensor.
% As part of this thesis an automated process for fetching, filtering and processing the data from NASA's API was developed.

% However, the challenge to obtain paired data remains. Most of the literature in super resolution rely on downscaling the HR images using a Gaussian kernel and adding white noise to generate the LR pairs required for training. 
% In Section \ref{sec:results} it was shown that this approach is not able to generalize well on different image domains. The domain gap between the synthetically degraded and real images is too large, resulting in an SR model that is not able to generalize to FOREST-2 images, rendering blurry results.


The degradation model adapted to FOREST-2 images and its effects were studied by comparing them to a baseline degradation in Section \ref{sec:results}. The results showed that this adapted model produces LR images that are consistently blurrier and with more powerful noise that is usually strongly correlated with the content of the image. Although introducing stronger degradation, the super resolution results for both pipelines are similar. This means that the SR model, despite starting from different LR images, is able to reconstruct the HR image with comparable quality, displaying its capacity and the fact that it is probably being under-utilized when using baseline degradations.  An upper bound to the PSNR that the model is able is  observed, regardless of the LR input . The introduction of newer SISR methods or multi-spectral SR may be beneficial to overcome this limitation in reconstruction performance.

When comparing the results of the adapted SR model with the baseline on real FOREST-2 images, a lot more of detail and edges seem to be present, at the cost of a small increment in the overall noise. The images have more power in a wide range of frequencies when compared against bicubic upsampling, in the order of 6dB. The amplified frequencies match the ones lost during the degradation process, implying that the adapted SR model is able to recover part of the signal.  This behavior is consistent with observations from the gradient magnitude analysis and the pixel-neighborhood correlation.

The sensitivity to differences between training data and arbitrary inputs is a very relevant result, as it shows the limitations of the implicit modelling approaches. While they clearly help to bridge the domain gap, they are not able to generalize to an arbitrary input that is outside of the target domain.
When applying the adapted SR model to bicubic downsampled images, the resulting image quality is unusable.
In this case, the direction of the gap is inverted. The estimated degradation kernel is more complex than the actual one, resulting in SR over-amplifying frequencies. This also highlights the difficulty of hand-picking the degradation model in classical dataset generation techniques, as it is easy to be overly optimistic or pessimistic when choosing the amount of degradation.
The phenomena was also analyzed using non-referenced image quality assessment metrics, where the domain-adapted SR model has significantly better score only when the input are real FOREST-2 images. 

Overall, the combination of probabilistic degradation modelling and SR yielded very promising results. It is a flexible approach, in the sense that it only requires two sufficiently large datasets that do not need to be paired. 
The drawbacks of implicit modelling are not as relevant here, compared to other tasks, because the conditions of the missions (and their degradation models) are almost static. Unlike other applications like smartphone images, where the amount of possible cameras and sensors are almost infinite, the number of sensors in a satellite remains the same and only the change of conditions due to the pass of time should be taken into account. This means that the degradation model can be trained on a very specific domain, and the LR input that will be used in the future will probably come from the same distribution. The end-to-end nature of this training framework allows to have multiple SR models, one for each wanted target domain, with very low-difficulty.

The implemented framework leverages on implicit modelling to estimate a degradation model and produce LR images that can be analyzed to study its impact in the SR process. This information is also incorporated in the training process in order to produce better results.
The development of methods for assessing SR performance without paired HR-LR images is also an important contribution due to the scarce nature of this type of data. While they may not sufficient to quantify the performance of the SR model, they are a good indicator of the quality of the results.

% This also provokes a limitation in model training. Right now, the best model during training is chosen as the one that maximizes the PSNR on the source domain of the validation set (That means, taking the HR image, degrading it to LR, super resolving it and comparing to the HR). While this is not a bad criteria at all, it would be better to pick the one that maximizes the PSNR on the target domain (directly upsampling the real FOREST-2 images), as it will be the relevant metric in a production environment. In order to do this, a paired dataset of at least 100 images of real FOREST-2 images paired with their HR counterparts is needed.

\subsection{Future Work}

The work presented in this thesis has laid the groundwork for doing degradation-aware super-resolution of FOREST-2 images without the need of paired data. While the results are promising, several assumptions can be challenged and many avenues remain unexplored. The following points outline promising directions for future research:

\begin{itemize}

    \item The HR dataset obtained from ECOSTRESS is based on the similarities in the spectral domain between the two missions. While their characteristics are very similar, they are not the same and the implications of this mismatch could be an interesting topic.
    \item Despite using unpaired data for training, the lack of a paired HR-LR dataset still poses a challenge, as it is not possible to quantify how good the adapted SR model is in super resolving real FOREST-2 images compared to other methods, due to the lack of a ground truth HR image. Moreover, the availability of a sufficient paired dataset would allow for better training decisions, leveraging on techniques like early stopping for model selection. 
    \item The addition of a discriminator that distinguishes between the real HR image and the super-resolved FOREST-2 images may improve the quality of the results even further. It may do so by aligning their distributions without the need of them being paired.
    \item The probabilistic degradation modelling assumes independence between the noise and kernel components. While it is a reasonable assumption, it may not hold in all cases.
    \item In the future, OroraTech will launch a constellation of cubesats that will have identical hardware, but the degradation model may be slightly different due to manufacturing tolerances and performance degradation over time. When more data is available, investigating whether a general model for all FOREST data products is possible or if each cubesat needs its own model will become interesting.
    \item While the NIQE and BRISQUE metrics are helpful to assess the quality of SR without a reference, their corresponding models are trained on natural images. The development of NIQE and BRISQUE metrics trained on remote sensing data may be more suitable for the task.
    \item The introduction of newer SISR architectures, or the incorporation of information from other spectral bands to do MSSR as in \cite{myself2023} may be beneficial to overcome the limitations of the SR model. MISR is also very promising, but the difficulty to obtain multi-image data from FOREST-2 is a challenging limitation for its application.
    \item Because of how the frequency domain analysis is done, the value o a particular spatial frequency is the average over every direction. This approach could be further developed to focus on specific directions.
\end{itemize}